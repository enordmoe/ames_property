<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="all participating group member names here">
<meta name="dcterms.date" content="2024-02-20">

<title>Analysis of Ames Property Data:</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ames_property_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="ames_property_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="ames_property_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="ames_property_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ames_property_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="ames_property_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ames_property_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ames_property_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ames_property_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ames_property_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#data-and-packages" id="toc-data-and-packages" class="nav-link active" data-scroll-target="#data-and-packages">Data and packages</a></li>
  <li><a href="#digging-into-the-data" id="toc-digging-into-the-data" class="nav-link" data-scroll-target="#digging-into-the-data">Digging Into the Data</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#further-investigation" id="toc-further-investigation" class="nav-link" data-scroll-target="#further-investigation">Further Investigation</a></li>
  <li><a href="#the-grand-finale" id="toc-the-grand-finale" class="nav-link" data-scroll-target="#the-grand-finale">The Grand Finale</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of Ames Property Data:</h1>
<p class="subtitle lead">An Exploratory Data Analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>all participating group member names here </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this exercise, you will use the concepts you have learned about thus far to carry out an analysis of a real data set. We will review ideas of data visualization and exploratory data analysis after which you will be asked to carry out several procedures on your own.</p>
<section id="data-and-packages" class="level1">
<h1>Data and packages</h1>
<p>We will use the <a href="https://www.tandfonline.com/doi/abs/10.1080/10691898.2011.11889627">AmesHousing</a> data, which provides information on the sales of individual residential properties in Ames, Iowa from 2006 to 2010. The data set contains 2930 observations, and a large number of explanatory variables involved in assessing home values. A full description of this dataset can be found <a href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt">here</a>. The command chunk below loads the library with the data and does some very useful pre-processing of the data. In particular, our use of the <code>make_ordinal_ames()</code> command produces a data set where categorical variables are stored as ordered factors making them easier to work with. (Note: This function includes code specific to the Ames data package and is not a general R feature.) Review the results of the <code>glimpse()</code> command to get a feel for the variable names and consult the detailed description linked above as needed.</p>
<div class="cell" data-hash="ames_property_analysis_cache/html/unnamed-chunk-2_f16924b8ea12889ecdef51f03c8a2b0f">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AmesHousing)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ames <span class="ot">&lt;-</span> <span class="fu">make_ordinal_ames</span>() <span class="co"># creates the data set caled ames</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,930
Columns: 81
$ MS_SubClass        &lt;fct&gt; One_Story_1946_and_Newer_All_Styles, One_Story_1946…
$ MS_Zoning          &lt;fct&gt; Residential_Low_Density, Residential_High_Density, …
$ Lot_Frontage       &lt;dbl&gt; 141, 80, 81, 93, 74, 78, 41, 43, 39, 60, 75, 0, 63,…
$ Lot_Area           &lt;int&gt; 31770, 11622, 14267, 11160, 13830, 9978, 4920, 5005…
$ Street             &lt;fct&gt; Pave, Pave, Pave, Pave, Pave, Pave, Pave, Pave, Pav…
$ Alley              &lt;fct&gt; No_Alley_Access, No_Alley_Access, No_Alley_Access, …
$ Lot_Shape          &lt;ord&gt; Slightly_Irregular, Regular, Slightly_Irregular, Re…
$ Land_Contour       &lt;ord&gt; Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, HLS, Lvl, Lvl, L…
$ Utilities          &lt;ord&gt; AllPub, AllPub, AllPub, AllPub, AllPub, AllPub, All…
$ Lot_Config         &lt;fct&gt; Corner, Inside, Corner, Corner, Inside, Inside, Ins…
$ Land_Slope         &lt;ord&gt; Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, G…
$ Neighborhood       &lt;fct&gt; North_Ames, North_Ames, North_Ames, North_Ames, Gil…
$ Condition_1        &lt;fct&gt; Norm, Feedr, Norm, Norm, Norm, Norm, Norm, Norm, No…
$ Condition_2        &lt;fct&gt; Norm, Norm, Norm, Norm, Norm, Norm, Norm, Norm, Nor…
$ Bldg_Type          &lt;fct&gt; OneFam, OneFam, OneFam, OneFam, OneFam, OneFam, Twn…
$ House_Style        &lt;fct&gt; One_Story, One_Story, One_Story, One_Story, Two_Sto…
$ Overall_Qual       &lt;ord&gt; Above_Average, Average, Above_Average, Good, Averag…
$ Overall_Cond       &lt;ord&gt; Average, Above_Average, Above_Average, Average, Ave…
$ Year_Built         &lt;int&gt; 1960, 1961, 1958, 1968, 1997, 1998, 2001, 1992, 199…
$ Year_Remod_Add     &lt;int&gt; 1960, 1961, 1958, 1968, 1998, 1998, 2001, 1992, 199…
$ Roof_Style         &lt;fct&gt; Hip, Gable, Hip, Hip, Gable, Gable, Gable, Gable, G…
$ Roof_Matl          &lt;fct&gt; CompShg, CompShg, CompShg, CompShg, CompShg, CompSh…
$ Exterior_1st       &lt;fct&gt; BrkFace, VinylSd, Wd Sdng, BrkFace, VinylSd, VinylS…
$ Exterior_2nd       &lt;fct&gt; Plywood, VinylSd, Wd Sdng, BrkFace, VinylSd, VinylS…
$ Mas_Vnr_Type       &lt;fct&gt; Stone, None, BrkFace, None, None, BrkFace, None, No…
$ Mas_Vnr_Area       &lt;dbl&gt; 112, 0, 108, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6…
$ Exter_Qual         &lt;ord&gt; Typical, Typical, Typical, Good, Typical, Typical, …
$ Exter_Cond         &lt;ord&gt; Typical, Typical, Typical, Typical, Typical, Typica…
$ Foundation         &lt;fct&gt; CBlock, CBlock, CBlock, CBlock, PConc, PConc, PConc…
$ Bsmt_Qual          &lt;ord&gt; Typical, Typical, Typical, Typical, Good, Typical, …
$ Bsmt_Cond          &lt;ord&gt; Good, Typical, Typical, Typical, Typical, Typical, …
$ Bsmt_Exposure      &lt;ord&gt; Gd, No, No, No, No, No, Mn, No, No, No, No, No, No,…
$ BsmtFin_Type_1     &lt;ord&gt; BLQ, Rec, ALQ, ALQ, GLQ, GLQ, GLQ, ALQ, GLQ, Unf, U…
$ BsmtFin_SF_1       &lt;dbl&gt; 2, 6, 1, 1, 3, 3, 3, 1, 3, 7, 7, 1, 7, 3, 3, 1, 3, …
$ BsmtFin_Type_2     &lt;ord&gt; Unf, LwQ, Unf, Unf, Unf, Unf, Unf, Unf, Unf, Unf, U…
$ BsmtFin_SF_2       &lt;dbl&gt; 0, 144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1120, 0…
$ Bsmt_Unf_SF        &lt;dbl&gt; 441, 270, 406, 1045, 137, 324, 722, 1017, 415, 994,…
$ Total_Bsmt_SF      &lt;dbl&gt; 1080, 882, 1329, 2110, 928, 926, 1338, 1280, 1595, …
$ Heating            &lt;fct&gt; GasA, GasA, GasA, GasA, GasA, GasA, GasA, GasA, Gas…
$ Heating_QC         &lt;ord&gt; Fair, Typical, Typical, Excellent, Good, Excellent,…
$ Central_Air        &lt;fct&gt; Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, …
$ Electrical         &lt;ord&gt; SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SB…
$ First_Flr_SF       &lt;int&gt; 1656, 896, 1329, 2110, 928, 926, 1338, 1280, 1616, …
$ Second_Flr_SF      &lt;int&gt; 0, 0, 0, 0, 701, 678, 0, 0, 0, 776, 892, 0, 676, 0,…
$ Low_Qual_Fin_SF    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Gr_Liv_Area        &lt;int&gt; 1656, 896, 1329, 2110, 1629, 1604, 1338, 1280, 1616…
$ Bsmt_Full_Bath     &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, …
$ Bsmt_Half_Bath     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Full_Bath          &lt;int&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 3, 2, …
$ Half_Bath          &lt;int&gt; 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, …
$ Bedroom_AbvGr      &lt;int&gt; 3, 2, 3, 3, 3, 3, 2, 2, 2, 3, 3, 3, 3, 2, 1, 4, 4, …
$ Kitchen_AbvGr      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Kitchen_Qual       &lt;ord&gt; Typical, Typical, Good, Excellent, Typical, Good, G…
$ TotRms_AbvGrd      &lt;int&gt; 7, 5, 6, 8, 6, 7, 6, 5, 5, 7, 7, 6, 7, 5, 4, 12, 8,…
$ Functional         &lt;ord&gt; Typ, Typ, Typ, Typ, Typ, Typ, Typ, Typ, Typ, Typ, T…
$ Fireplaces         &lt;int&gt; 2, 0, 0, 2, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, …
$ Fireplace_Qu       &lt;ord&gt; Good, No_Fireplace, No_Fireplace, Typical, Typical,…
$ Garage_Type        &lt;fct&gt; Attchd, Attchd, Attchd, Attchd, Attchd, Attchd, Att…
$ Garage_Finish      &lt;ord&gt; Fin, Unf, Unf, Fin, Fin, Fin, Fin, RFn, RFn, Fin, F…
$ Garage_Cars        &lt;dbl&gt; 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, …
$ Garage_Area        &lt;dbl&gt; 528, 730, 312, 522, 482, 470, 582, 506, 608, 442, 4…
$ Garage_Qual        &lt;ord&gt; Typical, Typical, Typical, Typical, Typical, Typica…
$ Garage_Cond        &lt;ord&gt; Typical, Typical, Typical, Typical, Typical, Typica…
$ Paved_Drive        &lt;ord&gt; Partial_Pavement, Paved, Paved, Paved, Paved, Paved…
$ Wood_Deck_SF       &lt;int&gt; 210, 140, 393, 0, 212, 360, 0, 0, 237, 140, 157, 48…
$ Open_Porch_SF      &lt;int&gt; 62, 0, 36, 0, 34, 36, 0, 82, 152, 60, 84, 21, 75, 0…
$ Enclosed_Porch     &lt;int&gt; 0, 0, 0, 0, 0, 0, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Three_season_porch &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Screen_Porch       &lt;int&gt; 0, 120, 0, 0, 0, 0, 0, 144, 0, 0, 0, 0, 0, 0, 140, …
$ Pool_Area          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Pool_QC            &lt;ord&gt; No_Pool, No_Pool, No_Pool, No_Pool, No_Pool, No_Poo…
$ Fence              &lt;ord&gt; No_Fence, Minimum_Privacy, No_Fence, No_Fence, Mini…
$ Misc_Feature       &lt;fct&gt; None, None, Gar2, None, None, None, None, None, Non…
$ Misc_Val           &lt;int&gt; 0, 0, 12500, 0, 0, 0, 0, 0, 0, 0, 0, 500, 0, 0, 0, …
$ Mo_Sold            &lt;int&gt; 5, 6, 6, 4, 3, 6, 4, 1, 3, 6, 4, 3, 5, 2, 6, 6, 6, …
$ Year_Sold          &lt;int&gt; 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 201…
$ Sale_Type          &lt;fct&gt; WD , WD , WD , WD , WD , WD , WD , WD , WD , WD , W…
$ Sale_Condition     &lt;fct&gt; Normal, Normal, Normal, Normal, Normal, Normal, Nor…
$ Sale_Price         &lt;int&gt; 215000, 105000, 172000, 244000, 189900, 195500, 213…
$ Longitude          &lt;dbl&gt; -93.61975, -93.61976, -93.61939, -93.61732, -93.638…
$ Latitude           &lt;dbl&gt; 42.05403, 42.05301, 42.05266, 42.05125, 42.06090, 4…</code></pre>
</div>
</div>
<p>Before proceeding, be sure you understand that each case represents a residential property that was sold during the period 2006–2010.</p>
</section>
<section id="digging-into-the-data" class="level1">
<h1>Digging Into the Data</h1>
<ol type="1">
<li>Use <strong>ggplot2</strong> to create a histogram of Ames housing sale prices.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="2" type="1">
<li>Create a scatterplot of sales price (y) against above ground living area (x).</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="3" type="1">
<li>You should have noticed 5 observations that are unusual for having considerably larger living area than most residential properties. Use an appropriate command to remove these very large properties and save the remaining data under the name <strong>ames2</strong>.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="4" type="1">
<li>Use the <strong>ames2</strong> data set here and for the rest of the lab. Create a scatterplot with log transformed variables (natural log, <code>log()</code>) and map kitchen quality to the color aesthetic.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="5" type="1">
<li>Create scatterplots of sale price by living area faceting for both kitchen quality and number of fireplaces. Again use the log transformation for price and area.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="6" type="1">
<li>Create a boxplot showing the relationship between log of sale price and kitchen quality.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="7" type="1">
<li>Create both a density plot (use <code>geom_density()</code>) and a <a href="https://r4ds.hadley.nz/layers.html#sec-geometric-objects:~:text=For%20example%2C%20the%20ggridges,the%20density%20curves%20transparent.">ridgeline plot</a> showing the relationship between log of sale price and number of fireplaces. A density plot is simply a smoothed histogram, smoothed to show the general pattern of variability in a fashion similar to the use of a smoother for a scatterplot. Instead of displaying count on the y axis, it displays by default the “density”, the count standardized so that the area under each density curve is one. The curve corresponding to each number of fireplaces should have a different color. Also set the <code>alpha</code> transparency so that all layers of the plot can be seen. (Hint: Is <code>Fireplaces</code> a factor variable? Should it be for this plot?)</li>
</ol>
<p><strong>Answer:</strong></p>
<div class="cell" data-hash="ames_property_analysis_cache/html/unnamed-chunk-9_74dcafda5fd319b02150a6f15b4cf08b">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation" class="level1">
<h1>Interpretation</h1>
<p><strong>Refer to the plots above</strong> to answer the following questions:</p>
<ol start="8" type="1">
<li>How many houses were sold with four fireplaces?</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="9" type="1">
<li>What are the five different levels for kitchen quality?</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="10" type="1">
<li>Do these graphs indicate that the quality of a kitchen could be related to the sale price? Explain in at least a couple sentences.</li>
</ol>
<p><strong>Answer:</strong></p>
</section>
<section id="further-investigation" class="level1">
<h1>Further Investigation</h1>
<ol start="11" type="1">
<li>Create a bar chart showing the number of sales for each level of kitchen quality.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="12" type="1">
<li>Create a histogram of the above ground living area, <code>Gr_Liv_Area</code>.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="13" type="1">
<li>Create a scatterplot using <code>Year_Built</code> as the explanatory variable and log of <code>Sale_Price</code> as the response variable. Include a linear fit smoothing line, a title, and labels for the x and y axes.</li>
</ol>
<p><strong>Answer:</strong></p>
<ol start="14" type="1">
<li>Modify the scatterplot in the previous question so that there is still only one line, but the points are colored by the overall condition of the home, <code>Overall_Cond</code>.</li>
</ol>
<p><strong>Answer:</strong></p>
</section>
<section id="the-grand-finale" class="level1">
<h1>The Grand Finale</h1>
<ol start="15" type="1">
<li><strong>Data Transformation and Graphing</strong> Use what you have learned about data transformations and graphics to carry out the following (still starting with the <strong>ames2</strong> data set:</li>
</ol>
<ul>
<li><p>Restrict the Ames housing data to only sales under normal conditions. In other words, <code>Condition_1 == "Norm"</code>.</p></li>
<li><p>Create a new home area variable called <code>Total_Sq_Ft = Gr_Liv_Area  +  Total_Bsmt_SF</code> and remove any homes with more than 3000 total square feet.</p></li>
<li><p>Create a new categorical variable <code>FireP</code> which is “No” if there are no fireplaces in the home and “Yes” if there is at least one fireplace in the home.</p></li>
</ul>
<p>With this modified data frame, create a graphic involving no more than three explanatory variables that portrays how to predict sales price. That is, create some form of graphic that shows covariation between price and area while incorporating a couple relevant categorical variables. You should be able to do this in one code chunk connected by the pipe <code>|&gt;</code> and <code>+</code> for the <code>ggplot()</code> layers.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>